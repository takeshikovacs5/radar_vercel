document.addEventListener("DOMContentLoaded",function(){var submitButton=document.getElementById("submitButton");submitButton.onclick=function(event){event.preventDefault();var player1Name=document.getElementById("player1_name").value;var player2Name=document.getElementById("player2_name").value;if(!player1Name||!player2Name){console.error("Please select two players");return}var xhr=new XMLHttpRequest;xhr.open("POST","/radar_chart",true);xhr.setRequestHeader("Content-Type","application/json");xhr.setRequestHeader("X-CSRFToken",csrfToken);xhr.onload=function(){if(xhr.status===200){document.getElementById("chartContainer").innerHTML=xhr.responseText}else{console.error("Error:",xhr.statusText)}};var data=JSON.stringify({player1_name:player1Name,player2_name:player2Name});xhr.send(data)}});document.addEventListener("DOMContentLoaded",function(){if(typeof mpld3!=="undefined"&&mpld3._mpld3IsLoaded){mpld3.draw_figure("chartContainer",JSON.parse("{{ chart_html | tojson | safe }}"))}else{console.warn("mpld3 is not loaded!")}});$(document).ready(function(){$("#chartImage").on("click",function(){$(this).toggleClass("enlarged")})});document.addEventListener("DOMContentLoaded",function(){document.getElementById("defender").checked=true;updatePlayers()});function updatePlayers(){var selectedPosition=document.querySelector('input[name="selected_position"]:checked').value;var player1Select=document.getElementById("player1");var player2Select=document.getElementById("player2");fetchPlayers(selectedPosition).then(function(players){player1Select.innerHTML="";player2Select.innerHTML="";players.forEach(function(player){var option=document.createElement("option");option.value=player;option.textContent=player;player1Select.appendChild(option);option=document.createElement("option");option.value=player;option.textContent=player;player2Select.appendChild(option)})})}function fetchPlayers(position){var url="";if(position==="FW"){url="https://raw.githubusercontent.com/scatterradarcsv/csv_scatter_radar/main/forwards.csv"}else if(position==="MF"){url="https://raw.githubusercontent.com/scatterradarcsv/csv_scatter_radar/main/midfielders.csv"}else if(position==="DF"){url="https://raw.githubusercontent.com/scatterradarcsv/csv_scatter_radar/main/defenders.csv"}return fetch(url).then(function(response){return response.text()}).then(function(csvData){var playerNames=csvData.split("\n").slice(1,-1).map(function(line){var columns=line.trim().split(",");return columns[columns.length-4]});playerNames.sort(function(a, b){return a.localeCompare(b)});return playerNames})}$(document).ready(function(){$("#chartForm").submit(function(event){event.preventDefault();$("#selectedPosition").val($('input[name="selected_position"]:checked').val());var formData=$(this).serialize();$("#loadingSpinner").show();function scrollToBottom(){$("html, body").animate({scrollTop:$("#chartContainer").offset().top},1600)}$.ajax({type:"POST",url:"/radar_chart",data:formData,cache:false,success:function(data){updateChart(data);$("#loadingSpinner").hide();scrollToBottom()},error:function(xhr,status,error){console.error("AJAX request failed:",status,error);$("#loadingSpinner").hide()}})});function updateChart(data){var chartContainer=$("#chartContainer");chartContainer.html(data)}});
